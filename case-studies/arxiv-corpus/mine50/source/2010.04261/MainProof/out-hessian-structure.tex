\subsubsection{Structure of Output Hessian of the First Layer}
\label{sec:proof-out-hessian}

We first restate \theoremref{thm:main-out} here:

\noindent\textbf{\theoremref{thm:main-out}} \emph{Let $\mM^*\triangleq \ex{\rmD'\mW^{(2)\T}\rmA\mW^{(2)}\rmD'}$ where $\rmD'$ is an independent copy of $\rmD$ and is also independent of $\rmA$. Let $S_1$ and $S_2$ be the top $c-1$ eigenspaces of $\mM^{(1)}$ and $\mM^*$ respectively, for all $\eps>0$,
\begin{equation}
    \lim_{n\to\infty}\mathop{\Pr}_{\mW^{(1)}\sim\gN(0,\frac{1}{d}\mI_{nd}), \mW^{(2)}\sim\gN(0,\frac{1}{n}\mI_{cn})}\left[\Overlap\left(S_1,S_2\right)>1-\eps\right] = 1.
\end{equation}
Moreover, as\begin{equation}
    \lim_{n\to\infty}\mathop{\Pr}_{\mW^{(1)}\sim\gN(0,\frac{1}{d}\mI_{nd}), \mW^{(2)}\sim\gN(0,\frac{1}{n}\mI_{cn})}\left[\left(\left.\frac{\lambda_c(\mM)}{\lambda_{c-1}(\mM)}\right|_{\mW^{(1)}, \mW^{(2)}}\right) < \eps\right] = 1.
\end{equation}}

\begin{proofof}{\theoremref{thm:main-out}}
\end{proofof}

From \lemmaref{lemma:M-proj-preserve-f-norm} we have 
\begin{equation}
    \lim_{n\to\infty}\frac{\fns{\mW\mM\mW^\T}}{\fns{\mM}}=1.
\end{equation}
Then we consider $\fns{\mW^\T\mW\mM \mW^\T\mW}$. Note that
\begin{equation}
\begin{split}
    \fns{\mW^\T\mW\mM\mW^\T\mW}&=\tr(\mW^\T\mW\mM\mW^\T\mW\mW^\T\mW\mM\mW^\T\mW)\\
    &=\tr(\mW\mW^\T\mW\mM\mW^\T\mW\mW^\T\mW\mM\mW^\T).
\end{split}
\end{equation}
From \lemmaref{lemma:WW-identity} we know that for all $\eps'>0$, $\lim_{n\to\infty}\Pr(\norm{\mW\mW^\T-\mI_c}\geq\eps')=0$. For notation simplicity, in this proof we will omit the limit and probability arguments which can be dealt with using union bound. Therefore, we will directly state $\norm{\mW\mW^\T-\mI_c}\leq\eps'$. From \cite{kleinman1968design} we know that for positive semi-definite matrices $\mA$ and $\mB$ we have $\lambda_{\min}(\mA)\tr(\mB)\leq \tr(\mA\mB)\leq \lambda_{\max}(\mA)\tr(\mB)$, so
\begin{equation}\begin{split}
    &|\tr(\mW\mW^\T\cdot \mW\mM \mW^\T\mW\mW^\T\mW\mM \mW^\T) - \tr(\mW\mM \mW^\T\mW\mW^\T\mW\mM \mW^\T)| \\
    \leq& \max\{1-\lambda_{\min}(\mW\mW^\T), \lambda_{\max}(\mW\mW^\T)-1\}\tr(\mW\mM \mW^\T\mW\mW^\T\mW\mM \mW^\T)\\
    \leq& \norm{\mW\mW^\T-\mI_c}\tr(\mW\mM \mW^\T\mW\mW^\T\mW\mM \mW^\T)\leq\eps'\tr(\mW\mM \mW^\T\mW\mW^\T\mW\mM \mW^\T).
\end{split}
\end{equation}
Similarly,
\begin{equation}\begin{split}
    &|\tr(\mW\mM \mW^\T\mW\mW^\T\mW\mM \mW^\T) - \tr(\mW\mM \mW^\T\mW\mM \mW^\T)|\\
    =&|\tr(\mW\mW^\T\cdot \mW\mM \mW^\T\mW\mM \mW^\T) - \tr(\mW\mM \mW^\T\mW\mM \mW^\T)|\\
    \leq&\norm{\mW\mW^\T-\mI_c}\tr(\mW\mM \mW^\T\mW\mM \mW^\T)\leq\eps'\tr(\mW\mM \mW^\T\mW\mM \mW^\T).
\end{split}\end{equation}
Therefore,
\begin{equation}\begin{split}
    &|\fns{\mW^\T\mW\mM \mW^\T\mW}-\fns{\mW\mM \mW^\T}|\\
    =&|\tr(\mW\mW^\T\cdot \mW\mM \mW^\T\mW\mW^\T\mW\mM \mW^\T) - \tr(\mW\mM \mW^\T\mW\mM \mW^\T)| \\
    \leq&|\tr(\mW\mW^\T\cdot \mW\mM \mW^\T\mW\mW^\T\mW\mM \mW^\T) - \tr(\mW\mM \mW^\T\mW\mW^\T\mW\mM \mW^\T)|\\
    &+|\tr(\mW\mM \mW^\T\mW\mW^\T\mW\mM \mW^\T) - \tr(\mW\mM \mW^\T\mW\mM \mW^\T)|\\
    \leq&\eps'\tr(\mW\mM \mW^\T\mW\mW^\T\mW\mM \mW^\T)+\eps'\tr(\mW\mM \mW^\T\mW\mM \mW^\T)\\
    \leq&\eps'(1+\eps')\tr(\mW\mM \mW^\T\mW\mM \mW^\T)+\eps'\tr(\mW\mM \mW^\T\mW\mM \mW^\T)\\
    \leq&(2\eps'+(\eps')^2)\tr(\mW\mM \mW^\T\mW\mM \mW^\T) = (2\eps'+(\eps')^2)\fns{\mW\mM \mW^\T}.
\end{split}\end{equation}
For all $\eps>0$, select $\eps'<\min\{\frac{\sqrt{\eps}}{2},\frac{\eps}{4}\}$, we have
\begin{equation}
    |\fns{\mW^\T\mW\mM \mW^\T\mW}-\fns{\mW\mM \mW^\T}|<\eps \fns{\mW\mM \mW^\T}.
\end{equation}
In other words,
\begin{equation}
    \lim_{n\to\infty}\frac{\fns{\mW^\T\mW\mM \mW^\T\mW}}{\fns{\mW\mM \mW^\T}}=1.
\end{equation}
Hence we get
\begin{equation}
    \lim_{n\to\infty}\frac{\fns{\mW^\T\mW\mM \mW^\T\mW}}{\fns{\mM }}=1.
\end{equation}
Next, consider the orthogonal projection matrix $P_\mW \triangleq \bmW^\T\bmW$ that projects vectors in $\R^n$ into the subspace spanned by all rows of $\mW$. Here $\bmW$ is the orthogonolized $\mW$, which is explicitly defined in \lemmaref{lemma:W-projection}.
We will consider the matrix $P_\mW\mM P_\mW$. Define $\delta\triangleq \mW^\T\mW-P_\mW$, then from \lemmaref{lemma:W-projection} we get $\fns{\delta}\leq\eps'$. Therefore,
\begin{equation}\begin{split}
    &|\fn{\mW^\T\mW\mM \mW^\T\mW} - \fn{P_\mW\mM P_\mW}|\\
    \leq\ &\fn{P_\mW\mM \delta} + \fn{\delta \mM P_\mW} + \fn{\delta \mM \delta}\\
    \leq\ &\fn{\mM }\pr{2\fn{P_\mW}\fn{\delta}+\fns{\delta}}\\
    \leq\ &\fn{\mM }\pr{2\cdot 4c^2\eps'+(\eps')^2}.
\end{split}\end{equation}
For all $\eps>0$, we choose $\eps'<\min\{\frac{\sqrt{\eps}}{2},\frac{\eps}{16c^2}\}$ and have
\begin{equation}
    \frac{|\fn{\mW^\T\mW\mM \mW^\T\mW} - \fn{P_\mW\mM P_\mW}|}{\fn{\mM }} < \eps,
\end{equation}
which means that
\begin{equation}
\begin{split}
    &\lim_{n\to\infty}\frac{|\fn{\mW^\T\mW\mM \mW^\T\mW} - \fn{P_\mW\mM P_\mW}|}{\fn{\mW^\T\mW\mM \mW^\T\mW}}\\
    =\ &\lim_{n\to\infty}\frac{|\fn{\mW^\T\mW\mM \mW^\T\mW} - \fn{P_\mW\mM P_\mW}|}{\fn{\mM }}=0.
\end{split}
\end{equation}
Thus,
\begin{equation}
    \lim_{n\to\infty}\frac{\fn{P_\mW\mM P_\mW}}{\fn{\mM }}=\lim_{n\to\infty}\frac{\fn{P_\mW\mM P_\mW}}{\fn{\mW^\T\mW\mM \mW^\T\mW}}=1.
\end{equation}
Note that $\fns{\mM }=\fns{P_\mW\mM P_\mW}+\fns{P_\mW\mM P_\mW^\perp}+\fns{P_\mW^\perp \mM P_\mW}+\fns{P_\mW^\perp \mM P_\mW^\perp}$. It follows that, 
\begin{equation}
\begin{split}
    &\lim_{n\to\infty}\frac{\fns{P_\mW\mM P_\mW^\perp}+\fns{P_\mW^\perp \mM P_\mW}+\fns{P_\mW^\perp \mM P_\mW^\perp}}{\fns{\mM }}\\
    =\ &\lim_{n\to\infty}\frac{\fns{\mM }-\fns{P_\mW\mM P_\mW}}{\fns{\mM }}=0.
\end{split}
\end{equation}
In other words,
\begin{equation}
    \lim_{n\to\infty}\frac{\fn{P_\mW\mM P_\mW^\perp}}{\fn{\mM }}=\lim_{n\to\infty}\frac{\fn{P_\mW^\perp \mM P_\mW}}{\fn{\mM }}=\lim_{n\to\infty}\frac{\fn{P_\mW^\perp \mM P_\mW^\perp}}{\fn{\mM }}=0.
\end{equation}
From \lemmaref{lemma:M-star} we know that for large $n$, $\lim_{n\to\infty}\fn{\mM }$ is lower bounded by some constant that is independent of $n$, so
\begin{equation}
    \lim_{n\to\infty}\fn{P_\mW\mM P_\mW^\perp} = \lim_{n\to\infty}\fn{P_\mW^\perp \mM P_\mW} = \lim_{n\to\infty}\fn{P_\mW^\perp \mM P_\mW^\perp} = 0.
\end{equation}
Note that
\begin{equation}
    \mM  = P_\mW\mM P_\mW + P_\mW\mM P_\mW^\perp + P_\mW^\perp \mM P_\mW + P_\mW^\perp \mM P_\mW^\perp.
\end{equation}
Thus,
\begin{equation}
    \lim_{n\to\infty}\fn{\mM -P_\mW\mM P_\mW}=0.
\end{equation}
For any $\eps>0$, set $\delta<\min\{\frac{\eps\eta}{8c^2},\frac{\sqrt{\eps\eta}}{2c}\}$, from \lemmaref{lemma:W-projection}, we know that with probability 1, $\fn{P_\mW-\mW^\T\mW}\leq\delta$. Therefore,
\begin{equation}\begin{split}
    &\fn{P_\mW\mM P_\mW-\mW^\T\mW\mM \mW^\T\mW}\\ \leq& \fns{P_\mW-\mW^\T\mW}\fn{\mM } + 2\fn{P_\mW-\mW^\T\mW}\fn{\mM }\fn{P_\mW}\\
                           \leq& \delta^2\cdot 2c^2 + 2\delta\cdot 2c^2\\
                           <& \eps.
\end{split}\end{equation}
In other words, 
\begin{equation}
    \lim_{n\to\infty}\fn{P_\mW\mM P_\mW-\mW^\T\mW\mM \mW^\T\mW}=0.
\end{equation}
Now we conclude that
\begin{equation}
    \lim_{n\to\infty}\fn{\mM -\mW^\T\mW\mM \mW^\T\mW} = 0.
\end{equation}
From \lemmaref{lemma:WMW-equivalence} we know that 
\begin{equation}
    \lim_{n\to\infty}\fn{\mW\mM \mW^\T-\mW\mM^*\mW^\T}=0.
\end{equation}
Since
\begin{equation}
    \fn{\mW^\T\mW\mM \mW^\T\mW-\mW^\T\mW\mM^*\mW^\T\mW}\leq \fns{\mW}\fn{\mW\mM \mW^\T-\mW\mM^*\mW^\T},
\end{equation}
from \lemmaref{lemma:W-norm} which bounds the Frobenius norm of $\mW$ we know that
\begin{equation}
    \lim_{n\to\infty}\fn{\mW^\T\mW\mM \mW^\T\mW-\mW^\T\mW\mM^*\mW^\T\mW} = 0.
\end{equation}
Thus,
\begin{equation}
\label{eqn:M-equal-WTWMWTW}
    \lim_{n\to\infty}\fn{\mM-\mW^\T\mW\mM^*\mW^\T\mW} = 0.
\end{equation}
Note that $\mM^*=\frac14\left(\E[\mW^\T\rmA\mW]+\text{diag}(\E[\mW^\T\rmA\mW])\right)$, so
\begin{equation}
\label{eqn:M-approx-complex}
    4\mW^\T\mW\mM^*\mW^\T\mW = \mW^\T\mW\mW^\T\tilde{\rmA}\mW\mW^\T\mW + \mW^\T\mW\text{diag}(\E[\mW^\T\rmA\mW])\mW^\T\mW.
\end{equation}
We will first analyze the second term on the RHS of equation \equationref{eqn:M-approx-complex}. For all $\eps>0$, set $\eps'=\frac{\eps}{\sqrt{c}}$, and from \lemmaref{lemma:WW-identity} we know that $\norm{\mW\mW^\T-\mI_c}<\eps'$ with probability 1, which means that $|\fn{\mW\mW^\T}-c|<\eps$ with probability 1. Set $\eps=c$, we know that $\fn{\mW\mW^\T}<2c$ with probability 1. Note that
\begin{equation}\begin{split}
    \fn{\mW^\T\mW\text{diag}(\E[\mW^\T\rmA\mW])\mW^\T\mW} &\leq\fns{\mW^\T\mW}\fn{\text{diag}(\E[\mW^\T\rmA\mW])}\\
                                        &=\fns{\mW\mW^\T}\fn{\text{diag}(\E[\mW^\T\rmA\mW])}\\
                                        &\leq 4c^2\fn{\text{diag}(\E[\mW^\T\rmA\mW])}.
\end{split}\end{equation}
Combine this with equation \equationref{lemma:W-diag-neg} and we have
\begin{equation}
    \lim_{n\to\infty}\frac{\fn{\mW^\T\mW\text{diag}(\E[\mW^\T\rmA\mW])\mW^\T\mW}}{\fn{\mW^\T\tilde{\rmA}\mW}} = 0.
\end{equation}
From \lemmaref{lemma:M-star} we know that $\fn{\mW^\T\tilde{\rmA}\mW}\geq\frac{\eta}{4}$ with probability 1, so
\begin{equation}
\label{eqn:WTWMWTW-equal-WTWWTAWWTW}
    \lim_{n\to\infty}\fn{4\mW^\T\mW\mM^*\mW^\T\mW - \mW^\T\mW\mW^\T\tilde{\rmA}\mW\mW^\T\mW} = 0.
\end{equation}
Similarly, define $\delta\triangleq \mW\mW^\T-\mI_c$, then
\begin{equation}\begin{split}
    &\fn{\mW^\T\mW\mW^\T\tilde{\rmA}\mW\mW^\T\mW - \mW^\T\tilde{\rmA}\mW}\\
\leq&\fn{\mW^\T\delta\tilde{\rmA}\delta \mW}+2\fn{\mW^\T\tilde{\rmA}\delta}\\
\leq&\fns{\mW}\fns{\delta}\fn{\tilde{\rmA}} + 2\fn{\mW}\fn{\delta}\fn{\tilde{\rmA}}.
\end{split}\end{equation}
Set $\eps'<\min\{\frac{\eps}{8c^2},\sqrt{\frac{\eps}{8c^3}}\}$, then from \lemmaref{lemma:WW-identity} we know that $\fn{\delta}<\eps'$ with probability 1, and from \lemmaref{lemma:W-norm} we have $\fn{\mW}\leq 2c$ with probability 1. We also have $\fn{\tilde{\rmA}}\leq c$ since each entry of $\rmA$ is bounded by 1 in absolute value.
Therefore,
\begin{equation}
\fn{\mW^\T\mW\mW^\T\tilde{\rmA}\mW\mW^\T\mW - \mW^\T\tilde{\rmA}\mW} \leq 4c^2(\eps')^2\cdot c + 2\cdot 2c\eps'\cdot c < \frac{\eps}{2} + \frac{\eps}{2} = \eps,
\end{equation}
which means that
\begin{equation}
\label{eqn:WTWWTAWWTW-equal-WTAW}
    \lim_{n\to\infty}\fn{\mW^\T\mW\mW^\T\tilde{\rmA}\mW\mW^\T\mW - \mW^\T\tilde{\rmA}\mW} = 0.
\end{equation}
From \equationref{eqn:WTWMWTW-equal-WTWWTAWWTW} and \equationref{eqn:WTWWTAWWTW-equal-WTAW} we get
\begin{equation}
\label{eqn:WTWMWTW-equal-WTAW}
    \lim_{n\to\infty}\fn{\frac14\mW^\T\tilde{\rmA}\mW - \mW^\T\mW\mM^*\mW^\T\mW} = 0.
\end{equation}
Combining with \equationref{eqn:M-equal-WTWMWTW} we have
\begin{equation}
    \lim_{n\to\infty}\fn{\mM - \frac14\mW^\T\tilde{\rmA}\mW} = 0.
\end{equation}
Besides, from equation \equationref{eqn:W-equal-W-bar} in \lemmaref{lemma:W-projection} we know that for any $\eps'>0$,
\begin{equation}
    \fns{\bmW-\mW} = \sum_{i\in[c]} \ns{\bmW_i-\mW_i}<\eps',
\end{equation}
where $\bmW$ is the orthogonal version of $\mW$, i.e., we run the Gram-Schmidt process for the rows of $\mW$. Define $\delta\triangleq \bmW-\mW$, for any $\eps>0$, set $\eps'=\min\{\frac{\eps}{8c^2},\sqrt{\frac{\eps}{2c}}\}$, we have with probability 1,
\begin{equation}\begin{split}
    \fn{\mW^\T\tilde{\rmA}\mW - \bmW^\T\tilde{\rmA}\bmW} &\leq 2\fn{\delta}\fn{\tilde{\rmA}}\fn{\mW} + \fns{\delta}\fn{\tilde{\rmA}}\\&\leq 4c^2\eps'+c(\eps')^2 < \eps.
\end{split}\end{equation}
Therefore,
\begin{equation}
    \lim_{n\to\infty}\fn{\mW^\T\tilde{\rmA}\mW - \bmW^\T\tilde{\rmA}\bmW} = 0,
\end{equation}
which implies
\begin{equation}
    \lim_{n\to\infty}\fn{\mM - \frac14\bmW^\T\tilde{\rmA}\bmW} = 0.
\end{equation}
From \lemmaref{lemma:A-rank-c-1} we know that with probability 1, $\tilde{\rmA}$ is of rank $(c-1)$. Since $\rmA\cdot\textbf{1}=0$ is always true, the top $(c-1)$ eigenspace of $\tilde{\rmA}$ is $\R^c\backslash\{\textbf{1}\}$. Note that the rows in $\bmW$ are of unit norm and orthogonal to each other, we conclude that $\bmW^\T\tilde{\rmA}\bmW$ is of rank $(c-1)$ and the corresponding eigenspace is $\gR\{\bmW_i\}_{i=1}^c\backslash\{\textbf{1}^\T\bmW\}$. Moreover, the minimum positive eigenvalue of $\bmW^\T\tilde{\rmA}\bmW$ is lower bounded by $\frac{\eta}{4}$.

As for the top $c-1$ eigenvectors of $\mM$, define $\delta\triangleq\mM-\frac14\bmW^\T\tilde{\rmA}\bmW$, then $\mM = \frac14\bmW^\T\tilde{\rmA}\bmW + \delta$. Define $S_1$ as the top $c-1$ eigenspaces for $\mM$, and $S_2$ to be the top $c-1$ eigenspaces for $\frac14\bmW^\T\tilde{\rmA}\bmW$. Then from Davis-Kahan Theorem we know that
\begin{equation}
    \fn{\sin\Theta(S_1,S_2)}\leq\frac{\fn{\delta}}{\lambda_{c-1}(\frac14\bmW^\T\tilde{\rmA}\bmW)}.
\end{equation}
Here $\Theta(S_1,S_2)$ is a $(c-1)\times(c-1)$ diagonal matrix whose $i$-th diagonal entry is the $i$-th canonical angle between $S_1$ and $S_2$. Since $\lim_{n\to\infty}\fn{\delta}=0$, and with probability 1, $\lambda_{c-1}(\frac14\bmW^\T\tilde{\rmA}\bmW)\geq\eta$ which is independent of $n$, we have with probability 1,
\begin{equation}
    \lim_{n\to\infty}\fn{\sin\Theta(S_1,S_2)} = 0,
\end{equation}
which indicates that the top $c-1$ eigenspaces for $\mM$ and $\frac14\bmW^\T\tilde{\rmA}\bmW$ are the same when $n\to\infty$.

Here we note that the top $c-1$ eigenspace of $\bmW^\T\tilde{\rmA}\bmW$ is $\gR\{\bmW_i\}_{i=1}^c\backslash\{\textbf{1}^\T\bmW\}$ since $\rmA$ has its null space spanned by the all-one vector, so $\mM$ will also have the same top $c-1$ eigenspaces. Besides, from equation \lemmaref{eqn:W-equal-W-bar} we know that $\lim_{n\to\infty}\fn{\mW-\bmW}=0$, so $\gR\{\bmW_i\}_{i=1}^c\backslash\{\textbf{1}^\T\bmW\}$ are the same as $\gR\{\mW_i\}_{i=1}^c\backslash\{\textbf{1}^\T\mW\}$. This completes the proof of this theorem.
