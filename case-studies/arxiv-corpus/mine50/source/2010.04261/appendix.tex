\newpage


\section*{Appendix Roadmap}
\begin{enumerate}
    \item In \cref{sec:appendix_derivation_main}, we provide the detailed derivations of Hessian for fully-connected and convolutional layers.
    \item In \cref{sec:appendix_full_hessian}, we provide detailed description on the approximation of dominating eigenvectors of the full hessian.
    \item In \cref{sec:appendix_eigencomp}, we explain how we compute the eigenvalues and eigenvectors of full and layer-wise Hessian numerically.
    \item In \cref{sec:appendix_exp_setup}, we give the detailed experiment setups, including the datasets, network structures, and the training settings we use.
    \item In \cref{sec:appendix_exp_res}, we provide detailed experimental results that are not fully included in the main text.
    \item In \cref{sec:appendix_explanation}, we provide additional and more general explanations of the phenomena we found.
    \item In \cref{sec:appendix_pac}, we give a detailed description of the PAC-Bayes bound that we optimize and the algorithm we use to optimize the bound.
    \item In \cref{sec:appendix_low_rank}, we provided the complete statement and proof for \cref{thm:gaussian_low_rank}.
    \item In \cref{sec:app_codes}, we give a brief description of the source code.
\end{enumerate}

\section{Detailed Derivations}
\label{sec:appendix_derivation_main}
\subsection{Derivation of Hessian}
\input{Appendix_Sections/derivations}
\subsection{Approximating Weight Hessian of Convolutional Layers}
\input{Appendix_Sections/conv_approximation}
\newpage
\input{Appendix_Sections/full_hessian}
\newpage
\input{Appendix_Sections/hessian_calc}
\input{Appendix_Sections/experiment_setup}
\input{Appendix_Sections/additional_exp}
\newpage
\newpage
\input{Appendix_Sections/additional_explanation}
\newpage
\section{Computing PAC-Bayes Bounds with Hessian Approximation}
\input{Appendix_Sections/pac_bayes}

\newpage

\section{Proofs and experiment for the low rank structure of the output Hessian}
\label{sec:appendix_low_rank}
\input{Appendix_Sections/Output_Hessian_Proof/output_hessian_lowrank_simple}
\section{Codes Description}
\input{Appendix_Sections/codes}
%\newpage
%\input{Author_response/icml2021_author_response}